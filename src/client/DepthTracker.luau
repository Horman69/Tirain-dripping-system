--[[
    DepthTracker.luau
    
    –ú–æ–¥—É–ª—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–ª—É–±–∏–Ω—ã –∏–≥—Ä–æ–∫–∞
    –≤ —Å–∏—Å—Ç–µ–º–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Å–ª–æ–µ–≤ –±–∏–æ–º–æ–≤
    
    –ê–≤—Ç–æ—Ä: Rus_ik000
    –î–∞—Ç–∞: 2025
--]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
local DigConfig = require(game.ReplicatedStorage.Shared.DigConfig)

-- –ú–æ–¥—É–ª—å
local DepthTracker = {}

-- –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- –°–æ–∑–¥–∞–Ω–∏–µ GUI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
local screenGui = nil
local depthLabel = nil
local biomeLabel = nil

-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
local UPDATE_FREQUENCY = 10 -- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥—É

--[[
    –°–æ–∑–¥–∞–µ—Ç GUI —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–ª—É–±–∏–Ω—ã
--]]
local function createDepthGui()
    -- –°–æ–∑–¥–∞–µ–º –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    screenGui = Instance.new("ScreenGui")
    screenGui.Name = "DepthTracker"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = playerGui
    
    -- –°–æ–∑–¥–∞–µ–º —Ñ—Ä–µ–π–º –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    local infoFrame = Instance.new("Frame")
    infoFrame.Name = "InfoFrame"
    infoFrame.Size = UDim2.new(0, 250, 0, 80)
    infoFrame.Position = UDim2.new(0, 10, 0, 10)
    infoFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    infoFrame.BackgroundTransparency = 0.3
    infoFrame.BorderSizePixel = 2
    infoFrame.BorderColor3 = Color3.fromRGB(255, 255, 255)
    infoFrame.Parent = screenGui
    
    -- –°–æ–∑–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "TitleLabel"
    titleLabel.Size = UDim2.new(1, 0, 0.3, 0)
    titleLabel.Position = UDim2.new(0, 0, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "üèÉ‚Äç‚ôÇÔ∏è –ì–õ–£–ë–ò–ù–ê"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.TextScaled = true
    titleLabel.Font = Enum.Font.SourceSansBold
    titleLabel.Parent = infoFrame
    
    -- –°–æ–∑–¥–∞–µ–º –ª–µ–π–±–ª –¥–ª—è –≥–ª—É–±–∏–Ω—ã
    depthLabel = Instance.new("TextLabel")
    depthLabel.Name = "DepthLabel"
    depthLabel.Size = UDim2.new(1, 0, 0.35, 0)
    depthLabel.Position = UDim2.new(0, 0, 0.3, 0)
    depthLabel.BackgroundTransparency = 1
    depthLabel.Text = "Y: 0 (–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å)"
    depthLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    depthLabel.TextScaled = true
    depthLabel.Font = Enum.Font.SourceSans
    depthLabel.Parent = infoFrame
    
    -- –°–æ–∑–¥–∞–µ–º –ª–µ–π–±–ª –¥–ª—è –±–∏–æ–º–∞
    biomeLabel = Instance.new("TextLabel")
    biomeLabel.Name = "BiomeLabel"
    biomeLabel.Size = UDim2.new(1, 0, 0.35, 0)
    biomeLabel.Position = UDim2.new(0, 0, 0.65, 0)
    biomeLabel.BackgroundTransparency = 1
    biomeLabel.Text = "üåç –ë–∏–æ–º: –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å"
    biomeLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
    biomeLabel.TextScaled = true
    biomeLabel.Font = Enum.Font.SourceSans
    biomeLabel.Parent = infoFrame
    
    print("‚úÖ DepthTracker GUI —Å–æ–∑–¥–∞–Ω")
end

--[[
    –û–±–Ω–æ–≤–ª—è–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã –∏ –±–∏–æ–º–∞
--]]
local function updateDepthDisplay()
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        return
    end
    
    local character = player.Character
    local humanoidRootPart = character.HumanoidRootPart
    local currentY = humanoidRootPart.Position.Y
    
    -- –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç –≥–ª—É–±–∏–Ω—ã
    local depthText = ""
    local depthColor = Color3.fromRGB(0, 255, 0) -- –ó–µ–ª–µ–Ω—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    
    if currentY > 0 then
        depthText = string.format("Y: %.1f (–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å)", currentY)
        depthColor = Color3.fromRGB(0, 255, 0) -- –ó–µ–ª–µ–Ω—ã–π –¥–ª—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
    else
        local depth = math.abs(currentY)
        depthText = string.format("Y: %.1f (–ì–ª—É–±–∏–Ω–∞ %.1f)", currentY, depth)
        
        -- –¶–≤–µ—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–ª—É–±–∏–Ω—ã
        if depth < 30 then
            depthColor = Color3.fromRGB(255, 255, 0) -- –ñ–µ–ª—Ç—ã–π –¥–ª—è –º–∞–ª–æ–π –≥–ª—É–±–∏–Ω—ã
        elseif depth < 100 then
            depthColor = Color3.fromRGB(255, 165, 0) -- –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è —Å—Ä–µ–¥–Ω–µ–π –≥–ª—É–±–∏–Ω—ã
        else
            depthColor = Color3.fromRGB(255, 0, 0) -- –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è –±–æ–ª—å—à–æ–π –≥–ª—É–±–∏–Ω—ã
        end
    end
    
    -- –û–ø—Ä–µ–¥–µ–ª—è–µ–º –±–∏–æ–º
    local biomeText = "üåç –ë–∏–æ–º: "
    local layerIndex = DigConfig.getLayerIndex(currentY)
    
    if currentY > 0 then
        biomeText = biomeText .. "–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å"
    else
        biomeText = biomeText .. "–°–ª–æ–π " .. layerIndex
    end
    
    -- –û–±–Ω–æ–≤–ª—è–µ–º GUI
    if depthLabel then
        depthLabel.Text = depthText
        depthLabel.TextColor3 = depthColor
    end
    
    if biomeLabel then
        biomeLabel.Text = biomeText
    end
end

--[[
    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≥–ª—É–±–∏–Ω—ã
--]]
function DepthTracker.initialize()
    print("DepthTracker: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...")
    
    -- –°–æ–∑–¥–∞–µ–º GUI
    createDepthGui()
    
    -- –ó–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    local connection = nil
    connection = RunService.Heartbeat:Connect(function()
        local dt = RunService.Heartbeat:Wait()
        
        -- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
        if tick() % (1/UPDATE_FREQUENCY) < dt then
            updateDepthDisplay()
        end
    end)
    
    -- –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–≥—Ä–æ–∫–∞
    Players.PlayerRemoving:Connect(function(leavingPlayer)
        if leavingPlayer == player and connection then
            connection:Disconnect()
        end
    end)
    
    print("‚úÖ DepthTracker –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
end

--[[
    –£–Ω–∏—á—Ç–æ–∂–∞–µ—Ç GUI —ç–ª–µ–º–µ–Ω—Ç—ã
--]]
function DepthTracker.cleanup()
    if screenGui then
        screenGui:Destroy()
        screenGui = nil
        depthLabel = nil
        biomeLabel = nil
    end
    
    print("DepthTracker: GUI –æ—á–∏—â–µ–Ω")
end

-- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–æ–¥—É–ª—å
return DepthTracker
